<div class="toc">  
    {% for heading in page.content | split: '<h' %}  
        {% if forloop.index0 != 0 %}  
            <h{% for i in (2..6) %}{{ heading | split: '>' | first | split: '<' | last | strip }}{% if forloop.last == false %} %endif %{% endfor %}>{{ heading | split: '>' | last | strip }}</h>  
            <ul>  
                <li><a href="#{{ heading | split: '>' | first | downcase | slugify }}">{{ heading | split: '>' | last | strip }}</a></li>  
            </ul>  
        {% endif %}  
    {% endfor %}  
</div>