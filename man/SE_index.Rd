% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/SE_index.R
\name{SE_index}
\alias{SE_index}
\title{SE_index: Compute Weighted Gene Index and Group Comparisons}
\usage{
SE_index(SE, DEfeature, assayname = "TPM", group_cols = NULL)
}
\arguments{
\item{SE}{A \code{SummarizedExperiment} object containing gene expression data.}

\item{DEfeature}{A named numeric vector: names are feature (e.g. gene) IDs,
values are weights (e.g. \code{-1} or \code{1}). Only features present
in \code{SE} are used.}

\item{assayname}{A string indicating which assay to use. Default is \code{"TPM"}.}

\item{group_cols}{A character vector of column names in \code{colData(SE)}
used for grouping. If \code{NULL}, only the index table is returned
(no plots or group statistics).}
}
\value{
A list with:
\item{index_df}{A data frame with columns \code{Sample}, \code{Index}, and
one column per feature (log2 expression).}
\item{plot}{When \code{group_cols} is not \code{NULL}, the last boxplot
produced (one per group column). Otherwise \code{NULL}.}
\item{data}{When \code{group_cols} is not \code{NULL}, a data frame of
group comparison statistics (N, mean, SD, AUC, CI, P_value, P_adj).
Otherwise an empty data frame with the same columns.}
}
\description{
This function computes a sample-level index (e.g. TB-Index) as a weighted
sum of z-scored gene expression from a \code{SummarizedExperiment} object.
When \code{group_cols} is provided, it generates boxplots by group and
performs pairwise ROC (AUC) and Wilcoxon tests between groups.
}
\examples{
# Build a named numeric vector of gene weights (e.g. from differential analysis)
DEfeatures <- c(
  SLC39A8 = -1, IQGAP2 = 1, DDX60L = -1, QRICH1 = 1,
  PPP1R7 = -1, SOD2 = 1, PLEK = -1, CCT3 = 1
)

# Load example SE (or use your own filtered SE)
SE <- loadSE()
# Compute index and group comparisons; use group column name in colData(SE)
x <- SE_index(SE = SE, assayname = "TPM", group_cols = "group", DEfeature = DEfeatures)
head(x$index_df)   # sample-level index
x$plot             # boxplot by group (if group_cols provided)
x$data             # AUC and Wilcoxon by group pair
}
